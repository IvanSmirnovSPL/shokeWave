C********************************************************************
C***   SHOCK_WAVE                                                 ***
C********************************************************************
	PROGRAM SHOCK_WAVE
C:::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
C=========================================================================
      REAL (KIND=8) PR_1,PR_2,RO_1,RO_2,T_1,T_2,A_1,MACH,TETA,BETA,GAMMA
      REAL (KIND=8) PI,R,V_1,ST,SB,CT,CB,DTDT,FT,ET,TET,MT,HT,Vn,Un
C=========================================================================
C:::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
      GAMMA = 1.4
C:::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
      PI = 3.1416
C:::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
      R = 8.3145D+03/29.
C:::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
      MACH  = 5.0
      BETA  = 15.0
C
      TETA = PI*BETA/360. + PI/4.
      BETA = PI*BETA/180.
C      
      PR_1 = 1.01325D+05
       T_1 = 288.0
C
      RO_1 = PR_1/(R*T_1) 
      A_1  = DSQRT (GAMMA*PR_1/RO_1)
      V_1  = MACH*A_1
C
      SB = DSIN (BETA)
      CB = DCOS (BETA)
C
      MT = (1./MACH)**2
C
      HT = 0.5*(GAMMA+1.)
C-----------------------------------------------------------------------
      ET = 1.
C-----------------------------------------------------------------------
      DO WHILE (ET > 1.0D-02)
C-----------------------------------------------------------------------
      ST = DSIN (TETA) 
      CT = DCOS (TETA)
C-----------------------------------------------------------------------
      DTDT =   2.*ST*CT - HT*CT*SB/ DCOS (TETA-BETA) - 
     -   DSIN (TETA-BETA)*HT*ST*SB/ DCOS (TETA-BETA)**2
C-----------------------------------------------------------------------
      FT = ST**2-HT*ST*SB/ DCOS (TETA-BETA) - MT
C-----------------------------------------------------------------------
      TET = TETA - FT/DTDT
C-----------------------------------------------------------------------
      ET = DABS ((TET-TETA)/TETA)
C-----------------------------------------------------------------------
      TETA = TET
C-----------------------------------------------------------------------
      END DO
C-----------------------------------------------------------------------
      Vn = V_1*DSIN(TETA)
      Un = 1.-(DSIN(TETA-BETA)*DCOS(TETA))/(DSIN(TETA)*DCOS(TETA-BETA))
C-----------------------------------------------------------------------
      RO_2 = RO_1/(1.-Un)
      PR_2 = PR_1+RO_1*Un*Vn**2
       T_2 = PR_2/(RO_2*R)
C-----------------------------------------------------------------------
      TETA = 180.*TETA/PI
      BETA = 180.*BETA/PI
C-----------------------------------------------------------------------
      WRITE(6,2)PR_2,RO_2,T_2,PR_1,RO_1,T_1,MACH,TETA,BETA
    2 FORMAT(60(1H=)/'  PR_2=',E10.3,'  RO_2=',E10.3,'  T_2=',E10.3/
     /               '  PR_1=',E10.3,'  RO_1=',E10.3,'  T_1=',E10.3/
     /               '  MACH=',E10.3,'  TETA=',E10.3,'  BETA=',E10.3/ 
     /       60(1H=))
C=========================================================================     
	END PROGRAM SHOCK_WAVE
